

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Decision Trees and Random Forests (Wildfire cause prediction) &#8212; Earth Data Science &amp; Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures_ML/SupervisedML/randomforests';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Assignment 2: Predicting Health Impacts from Air Quality Factors" href="../../assignments/Assignment2.html" />
    <link rel="prev" title="Supervised Machine Learning" href="supervisedml.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo_class.png" class="logo__image only-light" alt="Earth Data Science & Machine Learning - Home"/>
    <script>document.write(`<img src="../../_static/logo_class.png" class="logo__image only-dark" alt="Earth Data Science & Machine Learning - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to the Earth Data Science and Machine Learning Course Series
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Introduction/What-is-ML.html">What is machine learning?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Introduction/ML-for-climate-env.html">Machine Learning for Climate and Environmental Sustainability</a></li>

<li class="toctree-l1"><a class="reference internal" href="../Introduction/computing-environment.html">Computing Environment for Class</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Preprocessing and Feature Engineering</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../DataPreprocessing/datapreprocessing.html">Data Exploration and Data Pre-Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DataPreprocessing/datapreparation.html">Tutorial on Data Preprocessing (US Wildfires)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../assignments/Assignment1.html">Assignment 1: Data Pre-Processing of Historical Tropical Cyclone Records</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Supervised Machine Learning</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="supervisedml.html">Supervised Machine Learning</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Decision Trees and Random Forests (Wildfire cause prediction)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../assignments/Assignment2.html">Assignment 2: Predicting Health Impacts from Air Quality Factors</a></li>






</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kdlamb/ML4Climate2025" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kdlamb/ML4Climate2025/issues/new?title=Issue%20on%20page%20%2Flectures_ML/SupervisedML/randomforests.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/lectures_ML/SupervisedML/randomforests.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Decision Trees and Random Forests (Wildfire cause prediction)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-in-the-data-set">Load in the data set</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#separate-out-the-fires-with-no-known-cause">Separate out the fires with no known cause</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-pre-processing">Data Pre-Processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-validation-and-test-split">Training, validation, and test split</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-logistic-regression-natural-vs-human-causes">Train logistic regression (natural vs. human causes)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#roc-curve">ROC curve</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importance-of-different-features-for-logistic-regression">Importance of different features for logistic regression</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-a-decision-tree-classifier">Train a decision tree classifier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-a-random-forest-classifier">Train a random forest classifier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-importance">Feature importance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiclass-classification-with-the-random-forest">Multiclass classification with the Random Forest</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="decision-trees-and-random-forests-wildfire-cause-prediction">
<h1>Decision Trees and Random Forests (Wildfire cause prediction)<a class="headerlink" href="#decision-trees-and-random-forests-wildfire-cause-prediction" title="Permalink to this heading">#</a></h1>
<p>In this lesson, we will learn about decision trees and random forests and how they can be used for supervised machine learning tasks such as classification. A decision tree is an algorithm that can be used to determine how to classify or predict a target by making sequential decisions about the values of different features associated with a sample. Random forests use the ensemble vote of many decision trees to classify or predict a value.</p>
<p>We will use the data set from the paper <a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2024EF005187">“Inference of Wildfire Causes From Their Physical, Biological, Social and Management Attributes”</a> by Pourmohamad et al., Earth’s Future, 2025. In this paper, they explored whether its possible to determine the cause of a wildfire (in cases where the cause is unknown) based on data from other wildfires where the cause was known.</p>
<p><strong>References:</strong></p>
<p>[1]  Pourmohamad, Y., Abatzoglou, J. T., Fleishman, E., Short, K. C., Shuman, J., AghaKouchak, A., et al. (2025). Inference of wildfire causes from their physical, biological, social and management attributes. Earth’s Future, 13, e2024EF005187. <a class="reference external" href="https://doi.org/10.1029/2024EF005187">https://doi.org/10.1029/2024EF005187</a></p>
<p>[2] Pourmohamad, Y., Abatzoglou, J. T., Belval, E. J., Fleishman, E., Short, K., Reeves, M. C., Nauslar, N., Higuera, P. E., Henderson, E., Ball, S., AghaKouchak, A., Prestemon, J. P., Olszewski, J., and Sadegh, M.: Physical, social, and biological attributes for improved understanding and prediction of wildfires: FPA FOD-Attributes dataset, Earth Syst. Sci. Data, 16, 3045–3060, <a class="reference external" href="https://doi.org/10.5194/essd-16-3045-2024">https://doi.org/10.5194/essd-16-3045-2024</a>, 2024.</p>
<p>[3] Pourmohamad, Y. (2024). Inference of Wildfire Causes from Their Physical, Biological, Social and Management Attributes (0.1). Zenodo. <a class="reference external" href="https://doi.org/10.5281/zenodo.11510677">https://doi.org/10.5281/zenodo.11510677</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<section id="load-in-the-data-set">
<h2>Load in the data set<a class="headerlink" href="#load-in-the-data-set" title="Permalink to this heading">#</a></h2>
<p>The data set can be downloaded from <a class="reference external" href="https://zenodo.org/records/11510677">“https://zenodo.org/records/11510677”</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>wget<span class="w"> </span><span class="s2">&quot;https://zenodo.org/records/11510677/files/FPA_FOD_west_cleaned.csv&quot;</span><span class="w"> </span>data/.
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2025-07-17 01:30:16--  https://zenodo.org/records/11510677/files/FPA_FOD_west_cleaned.csv
Resolving zenodo.org (zenodo.org)... 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>188.185.43.25, 188.185.45.92, 188.185.48.194
Connecting to zenodo.org (zenodo.org)|188.185.43.25|:443... connected.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HTTP request sent, awaiting response... 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>200 OK
Length: 139402360 (133M) [text/plain]
Saving to: ‘FPA_FOD_west_cleaned.csv.1’


          FPA_FOD_w   0%[                    ]       0  --.-KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         FPA_FOD_we   0%[                    ]  80.64K   401KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        FPA_FOD_wes   0%[                    ] 329.71K   691KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       FPA_FOD_west   0%[                    ] 601.14K   886KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      FPA_FOD_west_   0%[                    ] 792.77K   837KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     FPA_FOD_west_c   0%[                    ]   1.05M   877KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    FPA_FOD_west_cl   1%[                    ]   1.37M   927KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   FPA_FOD_west_cle   1%[                    ]   1.63M   933KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  FPA_FOD_west_clea   1%[                    ]   1.91M   944KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> FPA_FOD_west_clean   1%[                    ]   2.15M   934KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FPA_FOD_west_cleane   1%[                    ]   2.43M   945KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PA_FOD_west_cleaned   2%[                    ]   3.07M  1.08MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A_FOD_west_cleaned.   2%[                    ]   3.91M  1.28MB/s    eta 1m 41s 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_FOD_west_cleaned.c   3%[                    ]   4.69M  1.44MB/s    eta 1m 41s 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FOD_west_cleaned.cs   4%[                    ]   5.56M  1.60MB/s    eta 1m 41s 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OD_west_cleaned.csv   4%[                    ]   6.53M  1.76MB/s    eta 1m 41s 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>D_west_cleaned.csv.   5%[&gt;                   ]   7.70M  2.05MB/s    eta 1m 41s 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_west_cleaned.csv.1   6%[&gt;                   ]   8.95M  2.32MB/s    eta 57s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>west_cleaned.csv.1    7%[&gt;                   ]   9.97M  2.63MB/s    eta 57s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>est_cleaned.csv.1     8%[&gt;                   ]  10.97M  2.85MB/s    eta 57s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>st_cleaned.csv.1      8%[&gt;                   ]  11.96M  3.06MB/s    eta 57s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t_cleaned.csv.1       9%[&gt;                   ]  13.08M  3.24MB/s    eta 57s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_cleaned.csv.1       10%[=&gt;                  ]  14.08M  3.55MB/s    eta 44s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cleaned.csv.1        11%[=&gt;                  ]  15.12M  3.75MB/s    eta 44s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>leaned.csv.1         12%[=&gt;                  ]  16.23M  4.00MB/s    eta 44s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eaned.csv.1          12%[=&gt;                  ]  16.60M  4.05MB/s    eta 44s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>aned.csv.1           13%[=&gt;                  ]  17.60M  4.21MB/s    eta 44s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ned.csv.1            14%[=&gt;                  ]  18.70M  4.50MB/s    eta 39s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ed.csv.1             14%[=&gt;                  ]  19.76M  4.56MB/s    eta 39s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>d.csv.1              15%[==&gt;                 ]  20.70M  4.57MB/s    eta 39s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.csv.1               16%[==&gt;                 ]  21.84M  4.60MB/s    eta 39s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>csv.1                17%[==&gt;                 ]  22.95M  4.69MB/s    eta 39s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sv.1                 17%[==&gt;                 ]  23.88M  4.57MB/s    eta 34s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v.1                  18%[==&gt;                 ]  24.93M  4.53MB/s    eta 34s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.1                   19%[==&gt;                 ]  26.03M  4.52MB/s    eta 34s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1                    20%[===&gt;                ]  27.16M  4.53MB/s    eta 34s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                     21%[===&gt;                ]  28.06M  4.54MB/s    eta 34s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  F  21%[===&gt;                ]  28.49M  4.29MB/s    eta 31s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 FP  21%[===&gt;                ]  29.20M  4.33MB/s    eta 31s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                FPA  22%[===&gt;                ]  29.50M  4.06MB/s    eta 31s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               FPA_  22%[===&gt;                ]  30.32M  4.09MB/s    eta 31s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              FPA_F  23%[===&gt;                ]  31.20M  4.23MB/s    eta 31s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             FPA_FO  24%[===&gt;                ]  32.27M  4.15MB/s    eta 30s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            FPA_FOD  25%[====&gt;               ]  33.30M  4.16MB/s    eta 30s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           FPA_FOD_  25%[====&gt;               ]  34.49M  4.16MB/s    eta 30s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          FPA_FOD_w  26%[====&gt;               ]  35.58M  4.15MB/s    eta 30s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         FPA_FOD_we  27%[====&gt;               ]  36.62M  4.15MB/s    eta 30s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        FPA_FOD_wes  28%[====&gt;               ]  37.46M  3.60MB/s    eta 29s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       FPA_FOD_west  28%[====&gt;               ]  38.23M  3.45MB/s    eta 29s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      FPA_FOD_west_  29%[====&gt;               ]  39.32M  3.58MB/s    eta 29s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     FPA_FOD_west_c  30%[=====&gt;              ]  40.07M  3.48MB/s    eta 29s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    FPA_FOD_west_cl  30%[=====&gt;              ]  40.83M  3.43MB/s    eta 29s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   FPA_FOD_west_cle  31%[=====&gt;              ]  41.64M  3.34MB/s    eta 27s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  FPA_FOD_west_clea  32%[=====&gt;              ]  42.69M  3.49MB/s    eta 27s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> FPA_FOD_west_clean  32%[=====&gt;              ]  43.66M  3.58MB/s    eta 27s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FPA_FOD_west_cleane  33%[=====&gt;              ]  44.50M  3.60MB/s    eta 27s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PA_FOD_west_cleaned  34%[=====&gt;              ]  45.45M  3.63MB/s    eta 27s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A_FOD_west_cleaned.  34%[=====&gt;              ]  46.44M  3.64MB/s    eta 25s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_FOD_west_cleaned.c  35%[======&gt;             ]  47.24M  3.49MB/s    eta 25s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FOD_west_cleaned.cs  36%[======&gt;             ]  48.12M  3.43MB/s    eta 25s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OD_west_cleaned.csv  37%[======&gt;             ]  49.23M  3.50MB/s    eta 25s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>D_west_cleaned.csv.  37%[======&gt;             ]  50.13M  3.45MB/s    eta 25s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_west_cleaned.csv.1  38%[======&gt;             ]  51.11M  3.54MB/s    eta 24s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>west_cleaned.csv.1   39%[======&gt;             ]  52.00M  3.99MB/s    eta 24s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>est_cleaned.csv.1    39%[======&gt;             ]  52.81M  4.03MB/s    eta 24s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>st_cleaned.csv.1     40%[=======&gt;            ]  53.76M  3.94MB/s    eta 24s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t_cleaned.csv.1      40%[=======&gt;            ]  54.45M  4.03MB/s    eta 24s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_cleaned.csv.1       41%[=======&gt;            ]  55.28M  4.05MB/s    eta 22s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cleaned.csv.1        42%[=======&gt;            ]  56.15M  4.01MB/s    eta 22s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>leaned.csv.1         42%[=======&gt;            ]  57.15M  3.98MB/s    eta 22s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eaned.csv.1          43%[=======&gt;            ]  57.98M  4.04MB/s    eta 22s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>aned.csv.1           43%[=======&gt;            ]  58.03M  3.69MB/s    eta 22s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ned.csv.1            43%[=======&gt;            ]  58.15M  3.53MB/s    eta 22s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ed.csv.1             44%[=======&gt;            ]  59.02M  3.49MB/s    eta 22s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>d.csv.1              45%[========&gt;           ]  60.15M  3.57MB/s    eta 22s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.csv.1               45%[========&gt;           ]  61.15M  3.64MB/s    eta 22s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>csv.1                46%[========&gt;           ]  62.21M  3.76MB/s    eta 22s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sv.1                 47%[========&gt;           ]  63.29M  3.76MB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v.1                  48%[========&gt;           ]  64.30M  3.65MB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.1                   49%[========&gt;           ]  65.32M  3.69MB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1                    49%[========&gt;           ]  66.31M  3.76MB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                     50%[=========&gt;          ]  67.05M  3.34MB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  F  51%[=========&gt;          ]  67.96M  3.39MB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 FP  51%[=========&gt;          ]  69.00M  3.41MB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                FPA  52%[=========&gt;          ]  69.97M  3.39MB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               FPA_  53%[=========&gt;          ]  71.00M  3.41MB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              FPA_F  54%[=========&gt;          ]  72.04M  3.40MB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             FPA_FO  54%[=========&gt;          ]  73.06M  3.85MB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            FPA_FOD  55%[==========&gt;         ]  74.15M  3.86MB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           FPA_FOD_  56%[==========&gt;         ]  75.06M  3.79MB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          FPA_FOD_w  57%[==========&gt;         ]  76.18M  3.92MB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         FPA_FOD_we  57%[==========&gt;         ]  76.75M  3.74MB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        FPA_FOD_wes  58%[==========&gt;         ]  77.63M  3.66MB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       FPA_FOD_west  59%[==========&gt;         ]  78.64M  3.71MB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      FPA_FOD_west_  59%[==========&gt;         ]  79.74M  3.72MB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     FPA_FOD_west_c  60%[===========&gt;        ]  80.22M  3.48MB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    FPA_FOD_west_cl  61%[===========&gt;        ]  81.38M  3.96MB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   FPA_FOD_west_cle  61%[===========&gt;        ]  82.38M  3.96MB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  FPA_FOD_west_clea  62%[===========&gt;        ]  83.51M  3.93MB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> FPA_FOD_west_clean  63%[===========&gt;        ]  84.51M  4.05MB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FPA_FOD_west_cleane  64%[===========&gt;        ]  85.59M  4.05MB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PA_FOD_west_cleaned  65%[============&gt;       ]  86.65M  4.11MB/s    eta 13s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A_FOD_west_cleaned.  65%[============&gt;       ]  87.69M  4.06MB/s    eta 13s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_FOD_west_cleaned.c  66%[============&gt;       ]  88.78M  4.20MB/s    eta 13s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FOD_west_cleaned.cs  67%[============&gt;       ]  89.91M  4.22MB/s    eta 13s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OD_west_cleaned.csv  68%[============&gt;       ]  90.95M  4.12MB/s    eta 13s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>D_west_cleaned.csv.  68%[============&gt;       ]  91.02M  3.63MB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_west_cleaned.csv.1  69%[============&gt;       ]  91.95M  3.69MB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>west_cleaned.csv.1   70%[=============&gt;      ]  93.06M  3.81MB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>est_cleaned.csv.1    70%[=============&gt;      ]  94.04M  3.76MB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>st_cleaned.csv.1     71%[=============&gt;      ]  94.89M  3.74MB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t_cleaned.csv.1      72%[=============&gt;      ]  95.98M  4.01MB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_cleaned.csv.1       72%[=============&gt;      ]  97.04M  3.99MB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cleaned.csv.1        73%[=============&gt;      ]  97.96M  4.02MB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>leaned.csv.1         74%[=============&gt;      ]  99.07M  4.01MB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eaned.csv.1          75%[==============&gt;     ] 100.13M  4.05MB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>aned.csv.1           76%[==============&gt;     ] 101.08M  3.94MB/s    eta 9s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ned.csv.1            76%[==============&gt;     ] 101.73M  3.86MB/s    eta 9s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ed.csv.1             77%[==============&gt;     ] 102.39M  3.66MB/s    eta 9s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>d.csv.1              77%[==============&gt;     ] 103.07M  3.65MB/s    eta 9s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.csv.1               77%[==============&gt;     ] 103.44M  3.36MB/s    eta 9s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>csv.1                78%[==============&gt;     ] 104.24M  3.42MB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sv.1                 78%[==============&gt;     ] 104.92M  3.88MB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v.1                  79%[==============&gt;     ] 106.00M  3.87MB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.1                   80%[===============&gt;    ] 107.04M  3.89MB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1                    81%[===============&gt;    ] 108.06M  3.88MB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                     82%[===============&gt;    ] 109.17M  3.96MB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  F  82%[===============&gt;    ] 110.23M  3.94MB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 FP  83%[===============&gt;    ] 111.27M  3.90MB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                FPA  84%[===============&gt;    ] 112.30M  4.01MB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               FPA_  85%[================&gt;   ] 113.37M  4.00MB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              FPA_F  86%[================&gt;   ] 114.44M  4.06MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             FPA_FO  86%[================&gt;   ] 115.54M  4.10MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            FPA_FOD  87%[================&gt;   ] 116.56M  4.22MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           FPA_FOD_  88%[================&gt;   ] 117.46M  4.27MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          FPA_FOD_w  89%[================&gt;   ] 118.62M  4.30MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         FPA_FOD_we  89%[================&gt;   ] 119.49M  4.48MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        FPA_FOD_wes  90%[=================&gt;  ] 120.47M  4.51MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       FPA_FOD_west  91%[=================&gt;  ] 121.39M  4.53MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      FPA_FOD_west_  92%[=================&gt;  ] 122.56M  4.52MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     FPA_FOD_west_c  93%[=================&gt;  ] 123.69M  4.52MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    FPA_FOD_west_cl  93%[=================&gt;  ] 124.25M  3.95MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   FPA_FOD_west_cle  93%[=================&gt;  ] 124.59M  3.77MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  FPA_FOD_west_clea  94%[=================&gt;  ] 125.62M  3.77MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> FPA_FOD_west_clean  95%[==================&gt; ] 126.73M  3.77MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FPA_FOD_west_cleane  95%[==================&gt; ] 127.58M  3.69MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PA_FOD_west_cleaned  96%[==================&gt; ] 128.41M  3.64MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A_FOD_west_cleaned.  97%[==================&gt; ] 129.30M  3.58MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_FOD_west_cleaned.c  98%[==================&gt; ] 130.31M  3.53MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FOD_west_cleaned.cs  98%[==================&gt; ] 131.36M  3.63MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OD_west_cleaned.csv  99%[==================&gt; ] 132.44M  3.69MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FPA_FOD_west_cleane 100%[===================&gt;] 132.94M  3.78MB/s    in 36s     

2025-07-17 01:30:52 (3.71 MB/s) - ‘FPA_FOD_west_cleaned.csv.1’ saved [139402360/139402360]

--2025-07-17 01:30:52--  http://data/
Resolving data (data)... failed: nodename nor servname provided, or not known.
wget: unable to resolve host address ‘data’
FINISHED --2025-07-17 01:30:52--
Total wall clock time: 36s
Downloaded: 1 files, 133M in 36s (3.71 MB/s)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;FPA_FOD_west_cleaned.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DISCOVERY_DOY</th>
      <th>FIRE_YEAR</th>
      <th>STATE</th>
      <th>FIPS_CODE</th>
      <th>NWCG_GENERAL_CAUSE</th>
      <th>Annual_etr</th>
      <th>Annual_precipitation</th>
      <th>Annual_tempreture</th>
      <th>pr</th>
      <th>tmmn</th>
      <th>...</th>
      <th>GHM</th>
      <th>NDVI-1day</th>
      <th>NPL</th>
      <th>Popo_1km</th>
      <th>RPL_THEMES</th>
      <th>RPL_THEME1</th>
      <th>RPL_THEME2</th>
      <th>RPL_THEME3</th>
      <th>RPL_THEME4</th>
      <th>Distance2road</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2007</td>
      <td>CA</td>
      <td>6053.0</td>
      <td>Misuse of fire by a minor</td>
      <td>1625</td>
      <td>257</td>
      <td>286.0</td>
      <td>0.0</td>
      <td>276.500000</td>
      <td>...</td>
      <td>0.42</td>
      <td>0.00</td>
      <td>1.0</td>
      <td>1.1494</td>
      <td>0.055</td>
      <td>0.027</td>
      <td>0.245</td>
      <td>0.039</td>
      <td>0.203</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2007</td>
      <td>CA</td>
      <td>6019.0</td>
      <td>Arson/incendiarism</td>
      <td>1819</td>
      <td>383</td>
      <td>290.0</td>
      <td>0.0</td>
      <td>273.200012</td>
      <td>...</td>
      <td>0.35</td>
      <td>0.50</td>
      <td>1.0</td>
      <td>0.1652</td>
      <td>0.525</td>
      <td>0.719</td>
      <td>0.499</td>
      <td>0.302</td>
      <td>0.405</td>
      <td>40.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>2007</td>
      <td>CA</td>
      <td>6089.0</td>
      <td>Misuse of fire by a minor</td>
      <td>2293</td>
      <td>985</td>
      <td>290.0</td>
      <td>0.0</td>
      <td>275.100006</td>
      <td>...</td>
      <td>0.16</td>
      <td>0.42</td>
      <td>1.0</td>
      <td>0.0504</td>
      <td>0.476</td>
      <td>0.635</td>
      <td>0.516</td>
      <td>0.002</td>
      <td>0.581</td>
      <td>43.8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>2007</td>
      <td>CA</td>
      <td>6089.0</td>
      <td>Misuse of fire by a minor</td>
      <td>2293</td>
      <td>985</td>
      <td>290.0</td>
      <td>0.0</td>
      <td>275.100006</td>
      <td>...</td>
      <td>0.16</td>
      <td>0.42</td>
      <td>1.0</td>
      <td>0.0504</td>
      <td>0.476</td>
      <td>0.635</td>
      <td>0.516</td>
      <td>0.002</td>
      <td>0.581</td>
      <td>43.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2007</td>
      <td>CA</td>
      <td>6079.0</td>
      <td>Debris and open burning</td>
      <td>2423</td>
      <td>102</td>
      <td>289.0</td>
      <td>0.0</td>
      <td>271.299988</td>
      <td>...</td>
      <td>0.18</td>
      <td>0.16</td>
      <td>1.0</td>
      <td>0.0718</td>
      <td>0.295</td>
      <td>0.309</td>
      <td>0.321</td>
      <td>0.105</td>
      <td>0.313</td>
      <td>41.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 40 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;DISCOVERY_DOY&#39;, &#39;FIRE_YEAR&#39;, &#39;STATE&#39;, &#39;FIPS_CODE&#39;,
       &#39;NWCG_GENERAL_CAUSE&#39;, &#39;Annual_etr&#39;, &#39;Annual_precipitation&#39;,
       &#39;Annual_tempreture&#39;, &#39;pr&#39;, &#39;tmmn&#39;, &#39;vs&#39;, &#39;fm100&#39;, &#39;fm1000&#39;, &#39;bi&#39;, &#39;vpd&#39;,
       &#39;erc&#39;, &#39;Elevation_1km&#39;, &#39;Aspect_1km&#39;, &#39;erc_Percentile&#39;, &#39;Slope_1km&#39;,
       &#39;TPI_1km&#39;, &#39;EVC&#39;, &#39;Evacuation&#39;, &#39;SDI&#39;, &#39;FRG&#39;, &#39;No_FireStation_5.0km&#39;,
       &#39;Mang_Name&#39;, &#39;GAP_Sts&#39;, &#39;GACC_PL&#39;, &#39;GDP&#39;, &#39;GHM&#39;, &#39;NDVI-1day&#39;, &#39;NPL&#39;,
       &#39;Popo_1km&#39;, &#39;RPL_THEMES&#39;, &#39;RPL_THEME1&#39;, &#39;RPL_THEME2&#39;, &#39;RPL_THEME3&#39;,
       &#39;RPL_THEME4&#39;, &#39;Distance2road&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>The data set includes meteorological, topological, social, and fire management variables:</p>
<ul class="simple">
<li><p>‘DISCOVERY_DOY’: Day of year on which the fire was discovered or confirmed to exist</p></li>
<li><p>‘FIRE_YEAR’: Calendar year in which the fire was discovered or confirmed to exist</p></li>
<li><p>‘STATE’: Two-letter alphabetic code for the state in which the fire burned (or originated), based on fire report</p></li>
<li><p>‘FIPS_CODE’: Five digit code from the Federal Information Process Standards publication 6-4 for representation of counties and equivalent entities, based on the nominal designation in the fire report.</p></li>
<li><p>‘Annual_etr’: Annual total reference evaporatranspiration (mm)</p></li>
<li><p>‘Annual_temperature’: Annual average temperature (K)</p></li>
<li><p>‘pr’ : Precipitation amount (mm)</p></li>
<li><p>‘tmmn’: Minimum temperature (K)</p></li>
<li><p>‘vs’: Wind velocity at 10 m above ground (m/s)</p></li>
<li><p>‘fm100’: 100-hour dead fuel moisture (%)</p></li>
<li><p>‘fm1000’: 1000-hour dead fuel moisture (%)</p></li>
<li><p>‘bi’: Burning index (NFDRS fire danger index)</p></li>
<li><p>‘vpd’: Mean vapor pressure deficit (kPa)</p></li>
<li><p>‘erc’: Energy release component (NFDRS fire danger index)</p></li>
<li><p>‘Elevation_1km’: Average elevation in 1 km radius around the ignition point</p></li>
<li><p>‘Aspect_1km’: Average aspect in 1 km radius around the ignition point</p></li>
<li><p>‘erc_Percentile’: Percentile range of energy release component</p></li>
<li><p>‘Slope_1km’: Average slope in 1 km radius around the ignition point</p></li>
<li><p>‘TPI_1km’: Average Topographic Position Index in 1 km radius around the ignition point</p></li>
<li><p>‘EVC’: Existing Vegetation Cover - vertically projected percent cover of the live canopy layer for a specific area (%)</p></li>
<li><p>‘Evacuation’: Estimate ground transport time in hours from the fire ignition point to a definitive care facility (hospital)</p></li>
<li><p>‘SDI’: Suppression difficulty index (Rodriguez y Silva et al. 2020): relative difficulty of fire control</p></li>
<li><p>‘FRG’: Fire regime group - presumed historical fire regime</p></li>
<li><p>‘No_FireStation_5.0km’: Number of fire stations in a 5 km radius around the fire ignition point</p></li>
<li><p>‘Mang_Name’: The land manager or administrative agency standardized for the US</p></li>
<li><p>‘GAP_Sts’: GAP status code classifies management intent to conserve biodiversity</p></li>
<li><p>‘GACC_PL’: Geographic Area Coordination Center (GACC) Preparedness Level</p></li>
<li><p>‘GDP’: Annual Gross Domestic Product Per Capita</p></li>
<li><p>‘GHM’: Cumulative Measure of the human modification of lands within 1 km of the fire ignition point</p></li>
<li><p>‘NDVI-1day’: Normalized Difference Vegetation Index (NDVI) on the day prior to ignition</p></li>
<li><p>‘NPL’: National Preparedness Level</p></li>
<li><p>‘Popo_1km’: Average population density within a 1 km radius around the fire ignition point</p></li>
<li><p>‘RPL_THEMES’: Social Vulnerability Index (Overall Percentile Ranking)</p></li>
<li><p>‘RPL_THEME1’: Percentile Ranking for socioeconomic theme summary</p></li>
<li><p>‘RPL_THEME2’: Percentile Ranking for Household Composition theme summary</p></li>
<li><p>‘RPL_THEME3’: Percentile Ranking for Minority Status/Language theme</p></li>
<li><p>‘RPL_THEME4’: Precentile ranking for Housing Type/Transportion theme</p></li>
<li><p>‘Distance2road’: Distance to the nearest road</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>519689
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 519689 entries, 0 to 519688
Data columns (total 40 columns):
 #   Column                Non-Null Count   Dtype  
---  ------                --------------   -----  
 0   DISCOVERY_DOY         519689 non-null  int64  
 1   FIRE_YEAR             519689 non-null  int64  
 2   STATE                 519689 non-null  object 
 3   FIPS_CODE             519689 non-null  float64
 4   NWCG_GENERAL_CAUSE    519689 non-null  object 
 5   Annual_etr            519689 non-null  int64  
 6   Annual_precipitation  519689 non-null  int64  
 7   Annual_tempreture     519689 non-null  float64
 8   pr                    519689 non-null  float64
 9   tmmn                  519689 non-null  float64
 10  vs                    519689 non-null  float64
 11  fm100                 519689 non-null  float64
 12  fm1000                519689 non-null  float64
 13  bi                    519689 non-null  float64
 14  vpd                   519689 non-null  float64
 15  erc                   519689 non-null  float64
 16  Elevation_1km         519689 non-null  float64
 17  Aspect_1km            519689 non-null  float64
 18  erc_Percentile        519689 non-null  float64
 19  Slope_1km             519689 non-null  float64
 20  TPI_1km               519689 non-null  float64
 21  EVC                   519689 non-null  float64
 22  Evacuation            519689 non-null  float64
 23  SDI                   519689 non-null  float64
 24  FRG                   519689 non-null  int64  
 25  No_FireStation_5.0km  519689 non-null  float64
 26  Mang_Name             519689 non-null  int64  
 27  GAP_Sts               519689 non-null  float64
 28  GACC_PL               519689 non-null  float64
 29  GDP                   519689 non-null  float64
 30  GHM                   519689 non-null  float64
 31  NDVI-1day             519689 non-null  float64
 32  NPL                   519689 non-null  float64
 33  Popo_1km              519689 non-null  float64
 34  RPL_THEMES            519689 non-null  float64
 35  RPL_THEME1            519689 non-null  float64
 36  RPL_THEME2            519689 non-null  float64
 37  RPL_THEME3            519689 non-null  float64
 38  RPL_THEME4            519689 non-null  float64
 39  Distance2road         519689 non-null  float64
dtypes: float64(32), int64(6), object(2)
memory usage: 158.6+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">firecauses</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;NWCG_GENERAL_CAUSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">firecauses</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NWCG_GENERAL_CAUSE
Natural                                       168349
Missing data/not specified/undetermined       150427
Equipment and vehicle use                      48994
Debris and open burning                        40516
Recreation and ceremony                        38665
Arson/incendiarism                             28090
Smoking                                        13547
Misuse of fire by a minor                      11523
Power generation/transmission/distribution      6469
Fireworks                                       6373
Railroad operations and maintenance             3074
Other causes                                    2068
Firearms and explosives use                     1594
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Deal with some bad data </span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;GHM&quot;</span><span class="p">]</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">,</span><span class="s2">&quot;GHM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SDI&quot;</span><span class="p">]</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">,</span><span class="s2">&quot;SDI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;FRG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;FRG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mi">9999</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;RPL_THEMES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;RPL_THEMES&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mf">999.0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;RPL_THEME1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;RPL_THEME1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mf">999.0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;RPL_THEME2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;RPL_THEME2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mf">999.0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;RPL_THEME3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;RPL_THEME3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mf">999.0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;RPL_THEME4&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;RPL_THEME4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mf">999.0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># extra code – the next 5 lines define the default font sizes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="c1">#save_fig(&quot;attribute_histogram_plots&quot;)  # extra code</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8d11b167d38ddbd0936dfbd31db89124689896c1ade960d05f16473a4c59b9ec.png" src="../../_images/8d11b167d38ddbd0936dfbd31db89124689896c1ade960d05f16473a4c59b9ec.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_cleaned</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="separate-out-the-fires-with-no-known-cause">
<h2>Separate out the fires with no known cause<a class="headerlink" href="#separate-out-the-fires-with-no-known-cause" title="Permalink to this heading">#</a></h2>
<p>First, let’s separate all of the fires where <code class="docutils literal notranslate"><span class="pre">NWCG_GENERAL_CAUSE</span></code> has the label <code class="docutils literal notranslate"><span class="pre">Missing</span> <span class="pre">data/not</span> <span class="pre">specified/undetermined</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_sorted</span> <span class="o">=</span> <span class="n">data_cleaned</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data_cleaned</span><span class="p">[</span><span class="s1">&#39;NWCG_GENERAL_CAUSE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Missing data/not specified/undetermined&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data_cleaned</span><span class="p">[</span><span class="s1">&#39;NWCG_GENERAL_CAUSE&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Missing data/not specified/undetermined&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_sorted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DISCOVERY_DOY</th>
      <th>FIRE_YEAR</th>
      <th>STATE</th>
      <th>FIPS_CODE</th>
      <th>NWCG_GENERAL_CAUSE</th>
      <th>Annual_etr</th>
      <th>Annual_precipitation</th>
      <th>Annual_tempreture</th>
      <th>pr</th>
      <th>tmmn</th>
      <th>...</th>
      <th>GHM</th>
      <th>NDVI-1day</th>
      <th>NPL</th>
      <th>Popo_1km</th>
      <th>RPL_THEMES</th>
      <th>RPL_THEME1</th>
      <th>RPL_THEME2</th>
      <th>RPL_THEME3</th>
      <th>RPL_THEME4</th>
      <th>Distance2road</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2007</td>
      <td>CA</td>
      <td>6065.0</td>
      <td>Missing data/not specified/undetermined</td>
      <td>2359</td>
      <td>100</td>
      <td>292.0</td>
      <td>0.0</td>
      <td>277.799988</td>
      <td>...</td>
      <td>0.84</td>
      <td>0.22</td>
      <td>1.0</td>
      <td>5.2191</td>
      <td>0.261</td>
      <td>0.167</td>
      <td>0.424</td>
      <td>0.427</td>
      <td>0.256</td>
      <td>38.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2007</td>
      <td>CA</td>
      <td>6065.0</td>
      <td>Missing data/not specified/undetermined</td>
      <td>2452</td>
      <td>110</td>
      <td>291.0</td>
      <td>0.0</td>
      <td>275.899994</td>
      <td>...</td>
      <td>0.61</td>
      <td>0.17</td>
      <td>1.0</td>
      <td>1.3687</td>
      <td>0.927</td>
      <td>0.969</td>
      <td>0.940</td>
      <td>0.846</td>
      <td>0.607</td>
      <td>38.3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>2007</td>
      <td>AZ</td>
      <td>0.0</td>
      <td>Missing data/not specified/undetermined</td>
      <td>3146</td>
      <td>135</td>
      <td>292.0</td>
      <td>0.0</td>
      <td>273.100006</td>
      <td>...</td>
      <td>0.04</td>
      <td>0.11</td>
      <td>1.0</td>
      <td>0.0000</td>
      <td>0.504</td>
      <td>0.829</td>
      <td>0.535</td>
      <td>0.046</td>
      <td>0.394</td>
      <td>36.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>2007</td>
      <td>CA</td>
      <td>6065.0</td>
      <td>Missing data/not specified/undetermined</td>
      <td>3546</td>
      <td>20</td>
      <td>297.0</td>
      <td>0.0</td>
      <td>277.100006</td>
      <td>...</td>
      <td>0.92</td>
      <td>0.04</td>
      <td>1.0</td>
      <td>8.1135</td>
      <td>0.611</td>
      <td>0.498</td>
      <td>0.653</td>
      <td>0.594</td>
      <td>0.688</td>
      <td>37.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2007</td>
      <td>CA</td>
      <td>6065.0</td>
      <td>Missing data/not specified/undetermined</td>
      <td>2486</td>
      <td>92</td>
      <td>292.0</td>
      <td>0.0</td>
      <td>277.799988</td>
      <td>...</td>
      <td>0.88</td>
      <td>0.18</td>
      <td>1.0</td>
      <td>13.7651</td>
      <td>0.939</td>
      <td>0.833</td>
      <td>0.879</td>
      <td>0.822</td>
      <td>0.875</td>
      <td>38.8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>518654</th>
      <td>364</td>
      <td>2003</td>
      <td>CO</td>
      <td>0.0</td>
      <td>Arson/incendiarism</td>
      <td>2222</td>
      <td>390</td>
      <td>284.0</td>
      <td>0.0</td>
      <td>263.500000</td>
      <td>...</td>
      <td>0.08</td>
      <td>0.29</td>
      <td>1.0</td>
      <td>0.0007</td>
      <td>0.464</td>
      <td>0.560</td>
      <td>0.089</td>
      <td>0.688</td>
      <td>0.695</td>
      <td>16.8</td>
    </tr>
    <tr>
      <th>518655</th>
      <td>364</td>
      <td>2003</td>
      <td>CO</td>
      <td>8043.0</td>
      <td>Arson/incendiarism</td>
      <td>1891</td>
      <td>636</td>
      <td>280.0</td>
      <td>0.0</td>
      <td>261.700012</td>
      <td>...</td>
      <td>0.06</td>
      <td>0.37</td>
      <td>1.0</td>
      <td>0.0003</td>
      <td>0.464</td>
      <td>0.560</td>
      <td>0.089</td>
      <td>0.688</td>
      <td>0.695</td>
      <td>16.8</td>
    </tr>
    <tr>
      <th>518656</th>
      <td>365</td>
      <td>2003</td>
      <td>CA</td>
      <td>6025.0</td>
      <td>Recreation and ceremony</td>
      <td>2846</td>
      <td>63</td>
      <td>298.0</td>
      <td>0.0</td>
      <td>286.500000</td>
      <td>...</td>
      <td>0.19</td>
      <td>-0.00</td>
      <td>1.0</td>
      <td>0.0000</td>
      <td>0.715</td>
      <td>0.914</td>
      <td>0.545</td>
      <td>0.500</td>
      <td>0.421</td>
      <td>8.7</td>
    </tr>
    <tr>
      <th>518657</th>
      <td>365</td>
      <td>2003</td>
      <td>CA</td>
      <td>0.0</td>
      <td>Debris and open burning</td>
      <td>1805</td>
      <td>994</td>
      <td>287.0</td>
      <td>0.0</td>
      <td>274.100006</td>
      <td>...</td>
      <td>0.39</td>
      <td>0.02</td>
      <td>1.0</td>
      <td>0.4738</td>
      <td>0.216</td>
      <td>0.509</td>
      <td>0.207</td>
      <td>0.008</td>
      <td>0.151</td>
      <td>33.6</td>
    </tr>
    <tr>
      <th>518658</th>
      <td>365</td>
      <td>2003</td>
      <td>CA</td>
      <td>6065.0</td>
      <td>Equipment and vehicle use</td>
      <td>2048</td>
      <td>318</td>
      <td>292.0</td>
      <td>0.0</td>
      <td>280.399994</td>
      <td>...</td>
      <td>0.81</td>
      <td>0.11</td>
      <td>1.0</td>
      <td>1.1717</td>
      <td>0.636</td>
      <td>0.785</td>
      <td>0.567</td>
      <td>0.453</td>
      <td>0.377</td>
      <td>6.1</td>
    </tr>
  </tbody>
</table>
<p>518659 rows × 40 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_unknown</span> <span class="o">=</span> <span class="n">data_sorted</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_sorted</span><span class="p">[</span><span class="s2">&quot;NWCG_GENERAL_CAUSE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Missing data/not specified/undetermined&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data_known</span> <span class="o">=</span> <span class="n">data_sorted</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_sorted</span><span class="p">[</span><span class="s2">&quot;NWCG_GENERAL_CAUSE&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;Missing data/not specified/undetermined&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_known</span><span class="p">[</span><span class="s2">&quot;NWCG_GENERAL_CAUSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NWCG_GENERAL_CAUSE
Natural                                       168126
Equipment and vehicle use                      48895
Debris and open burning                        40450
Recreation and ceremony                        38498
Arson/incendiarism                             28035
Smoking                                        13510
Misuse of fire by a minor                      11508
Power generation/transmission/distribution      6453
Fireworks                                       6348
Railroad operations and maintenance             3062
Other causes                                    2064
Firearms and explosives use                     1584
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Since only the first class is due to natural causes (typically ignition is due to lightning), and all the other categories are related to human activity, we can also label fires as being “natural” or “anthropogenic”. We’ll create a binary variable called “IsNatural” which has a value of 1 (True) if it is fire caused by natural causes or 0 (False) if it is a fire caused by any of the other causes related to human activity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_known</span><span class="p">[</span><span class="s2">&quot;IsNatural&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_known</span><span class="p">[</span><span class="s2">&quot;NWCG_GENERAL_CAUSE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Natural&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_known</span><span class="p">[</span><span class="s2">&quot;IsNatural&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IsNatural
0    200407
1    168126
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-pre-processing">
<h2>Data Pre-Processing<a class="headerlink" href="#data-pre-processing" title="Permalink to this heading">#</a></h2>
<p>For decision trees and random forests, we generally don’t have to worry as much about scaling (compared with models like neural networks), since they work based on finding threshold values in the data sets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">OrdinalEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">causes</span> <span class="o">=</span> <span class="n">data_known</span><span class="p">[[</span><span class="s1">&#39;NWCG_GENERAL_CAUSE&#39;</span><span class="p">]]</span>
<span class="n">isnatural</span> <span class="o">=</span> <span class="n">data_known</span><span class="p">[[</span><span class="s2">&quot;IsNatural&quot;</span><span class="p">]]</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">data_known</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;NWCG_GENERAL_CAUSE&quot;</span><span class="p">,</span><span class="s2">&quot;IsNatural&quot;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">features_unknown</span> <span class="o">=</span> <span class="n">data_unknown</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;NWCG_GENERAL_CAUSE&quot;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll create two labels for our data set. The first is a binary label, for whether the fire was caused by natural or anthropogenic causes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_binary</span> <span class="o">=</span> <span class="n">isnatural</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classnames_binary</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Anthropogenic&quot;</span><span class="p">,</span><span class="s2">&quot;Natural&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The second set of labels will be multi-class, and include all of the possible causes for the fires included in the <code class="docutils literal notranslate"><span class="pre">NWCG_GENERAL_CAUSE</span></code> column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ordenc</span> <span class="o">=</span> <span class="n">OrdinalEncoder</span><span class="p">()</span>
<span class="n">y_multiclass</span> <span class="o">=</span> <span class="n">ordenc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">causes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classnames_multi</span> <span class="o">=</span> <span class="n">ordenc</span><span class="o">.</span><span class="n">categories_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classnames_multi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Arson/incendiarism&#39; &#39;Debris and open burning&#39;
 &#39;Equipment and vehicle use&#39; &#39;Firearms and explosives use&#39; &#39;Fireworks&#39;
 &#39;Misuse of fire by a minor&#39; &#39;Natural&#39; &#39;Other causes&#39;
 &#39;Power generation/transmission/distribution&#39;
 &#39;Railroad operations and maintenance&#39; &#39;Recreation and ceremony&#39; &#39;Smoking&#39;]
</pre></div>
</div>
</div>
</div>
<p>Now we will create the pipeline to transform the variables in the <code class="docutils literal notranslate"><span class="pre">features</span></code> dataframe as input to the model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorical_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;STATE&quot;</span><span class="p">]</span>
<span class="n">numerical_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DISCOVERY_DOY&#39;</span><span class="p">,</span> <span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;FIPS_CODE&#39;</span><span class="p">,</span> <span class="s1">&#39;Annual_etr&#39;</span><span class="p">,</span> <span class="s1">&#39;Annual_precipitation&#39;</span><span class="p">,</span><span class="s1">&#39;Annual_tempreture&#39;</span><span class="p">,</span> 
                  <span class="s1">&#39;pr&#39;</span><span class="p">,</span> <span class="s1">&#39;tmmn&#39;</span><span class="p">,</span> <span class="s1">&#39;vs&#39;</span><span class="p">,</span> <span class="s1">&#39;fm100&#39;</span><span class="p">,</span> <span class="s1">&#39;fm1000&#39;</span><span class="p">,</span> <span class="s1">&#39;bi&#39;</span><span class="p">,</span> <span class="s1">&#39;vpd&#39;</span><span class="p">,</span> <span class="s1">&#39;erc&#39;</span><span class="p">,</span> <span class="s1">&#39;Elevation_1km&#39;</span><span class="p">,</span> <span class="s1">&#39;Aspect_1km&#39;</span><span class="p">,</span> <span class="s1">&#39;erc_Percentile&#39;</span><span class="p">,</span> 
                  <span class="s1">&#39;Slope_1km&#39;</span><span class="p">,</span><span class="s1">&#39;TPI_1km&#39;</span><span class="p">,</span> <span class="s1">&#39;EVC&#39;</span><span class="p">,</span> <span class="s1">&#39;Evacuation&#39;</span><span class="p">,</span> <span class="s1">&#39;SDI&#39;</span><span class="p">,</span> <span class="s1">&#39;FRG&#39;</span><span class="p">,</span> <span class="s1">&#39;No_FireStation_5.0km&#39;</span><span class="p">,</span><span class="s1">&#39;Mang_Name&#39;</span><span class="p">,</span> <span class="s1">&#39;GAP_Sts&#39;</span><span class="p">,</span> 
                  <span class="s1">&#39;GACC_PL&#39;</span><span class="p">,</span> <span class="s1">&#39;GDP&#39;</span><span class="p">,</span> <span class="s1">&#39;GHM&#39;</span><span class="p">,</span> <span class="s1">&#39;NDVI-1day&#39;</span><span class="p">,</span> <span class="s1">&#39;NPL&#39;</span><span class="p">,</span><span class="s1">&#39;Popo_1km&#39;</span><span class="p">,</span> <span class="s1">&#39;RPL_THEMES&#39;</span><span class="p">,</span> <span class="s1">&#39;RPL_THEME1&#39;</span><span class="p">,</span> <span class="s1">&#39;RPL_THEME2&#39;</span><span class="p">,</span> <span class="s1">&#39;RPL_THEME3&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;RPL_THEME4&#39;</span><span class="p">,</span> <span class="s1">&#39;Distance2road&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_pipeline</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">OrdinalEncoder</span><span class="p">(),</span><span class="n">StandardScaler</span><span class="p">())</span>
<span class="n">num_pipeline</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">StandardScaler</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">,</span><span class="n">num_pipeline</span><span class="p">,</span><span class="n">numerical_cols</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="n">cat_pipeline</span><span class="p">,</span><span class="n">categorical_cols</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_known</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll use the same pipeline to transform the features associated with the unknown fires. In this case we will use <code class="docutils literal notranslate"><span class="pre">transform</span></code> rather than <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code>. The difference is that the scalings and transformations will be based on the data in <code class="docutils literal notranslate"><span class="pre">features</span></code> (rather than <code class="docutils literal notranslate"><span class="pre">features_unknown</span></code>) so we will end up performing exactly the same scalings and transformations on both data sets. This is important because the models that we will train later will depend on these scalings and transformations being consistent across both data sets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_unknown</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">features_unknown</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">X_known</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">X_unknown</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(368533, 39) (150126, 39)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">featurenames</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">featurenames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;n__DISCOVERY_DOY&#39; &#39;n__FIRE_YEAR&#39; &#39;n__FIPS_CODE&#39; &#39;n__Annual_etr&#39;
 &#39;n__Annual_precipitation&#39; &#39;n__Annual_tempreture&#39; &#39;n__pr&#39; &#39;n__tmmn&#39;
 &#39;n__vs&#39; &#39;n__fm100&#39; &#39;n__fm1000&#39; &#39;n__bi&#39; &#39;n__vpd&#39; &#39;n__erc&#39;
 &#39;n__Elevation_1km&#39; &#39;n__Aspect_1km&#39; &#39;n__erc_Percentile&#39; &#39;n__Slope_1km&#39;
 &#39;n__TPI_1km&#39; &#39;n__EVC&#39; &#39;n__Evacuation&#39; &#39;n__SDI&#39; &#39;n__FRG&#39;
 &#39;n__No_FireStation_5.0km&#39; &#39;n__Mang_Name&#39; &#39;n__GAP_Sts&#39; &#39;n__GACC_PL&#39;
 &#39;n__GDP&#39; &#39;n__GHM&#39; &#39;n__NDVI-1day&#39; &#39;n__NPL&#39; &#39;n__Popo_1km&#39; &#39;n__RPL_THEMES&#39;
 &#39;n__RPL_THEME1&#39; &#39;n__RPL_THEME2&#39; &#39;n__RPL_THEME3&#39; &#39;n__RPL_THEME4&#39;
 &#39;n__Distance2road&#39; &#39;c__STATE&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="training-validation-and-test-split">
<h2>Training, validation, and test split<a class="headerlink" href="#training-validation-and-test-split" title="Permalink to this heading">#</a></h2>
<p>Then we will split the data where the cause of the fire is known into training, validation, and test data sets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll create an index z as input to the <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code> function. This way, we can select either the binary or multiclass labels for our training, validation, and test data sets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_known</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">X_known</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_val_test</span><span class="p">,</span> <span class="n">z_train</span><span class="p">,</span> <span class="n">z_val_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_known</span><span class="p">,</span><span class="n">z_known</span><span class="p">,</span><span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
<span class="n">X_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">z_val</span><span class="p">,</span> <span class="n">z_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_val_test</span><span class="p">,</span> <span class="n">z_val_test</span> <span class="p">,</span><span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(294826,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_multiclass_train</span> <span class="o">=</span> <span class="n">y_multiclass</span><span class="p">[</span><span class="n">z_train</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">y_multiclass_test</span> <span class="o">=</span> <span class="n">y_multiclass</span><span class="p">[</span><span class="n">z_test</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">y_multiclass_val</span> <span class="o">=</span> <span class="n">y_multiclass</span><span class="p">[</span><span class="n">z_val</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">y_binary_train</span> <span class="o">=</span> <span class="n">y_binary</span><span class="p">[</span><span class="n">z_train</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">y_binary_test</span> <span class="o">=</span> <span class="n">y_binary</span><span class="p">[</span><span class="n">z_test</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">y_binary_val</span> <span class="o">=</span> <span class="n">y_binary</span><span class="p">[</span><span class="n">z_val</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_binary_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y_binary_val</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y_binary_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(294826, 39) (36853, 39) (36854, 39)
(294826,) (36853,) (36854,)
</pre></div>
</div>
</div>
</div>
</section>
<section id="train-logistic-regression-natural-vs-human-causes">
<h2>Train logistic regression (natural vs. human causes)<a class="headerlink" href="#train-logistic-regression-natural-vs-human-causes" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="n">log_reg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s2">&quot;lbfgs&quot;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_binary_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LogisticRegression(random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression(random_state=42)</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_reg</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_binary_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8811231031184495
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_reg</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span><span class="n">y_binary_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.882479038341519
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train_predicted</span> <span class="o">=</span> <span class="n">log_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">y_val_predicted</span> <span class="o">=</span> <span class="n">log_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">ConfusionMatrixDisplay</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_binary_val</span><span class="p">,</span> <span class="n">y_val_predicted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[17695,  2302],
       [ 2029, 14827]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_binary_train</span><span class="p">,</span> <span class="n">y_train_predicted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[142077,  18472],
       [ 16576, 117701]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ConfusionMatrixDisplay</span><span class="o">.</span><span class="n">from_predictions</span><span class="p">(</span><span class="n">y_binary_train</span><span class="p">,</span> <span class="n">y_train_predicted</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="n">display_labels</span><span class="o">=</span><span class="n">classnames_binary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x34cf02b80&gt;
</pre></div>
</div>
<img alt="../../_images/2049ad8408294998aaaa97d379d306c91035a30790c2b031eb45437add842868.png" src="../../_images/2049ad8408294998aaaa97d379d306c91035a30790c2b031eb45437add842868.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ConfusionMatrixDisplay</span><span class="o">.</span><span class="n">from_predictions</span><span class="p">(</span><span class="n">y_binary_val</span><span class="p">,</span> <span class="n">y_val_predicted</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="n">display_labels</span><span class="o">=</span><span class="n">classnames_binary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x177a81610&gt;
</pre></div>
</div>
<img alt="../../_images/be8bbc71a55392f1ab047d5fa36e05899189ebcbf18887853275dcee6d363de1.png" src="../../_images/be8bbc71a55392f1ab047d5fa36e05899189ebcbf18887853275dcee6d363de1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Accuracy</strong> is defined as</p>
<p><span class="math notranslate nohighlight">\(\frac{TP+TN}{TP+TN+FP+FN}\)</span></p>
<p>where</p>
<ul class="simple">
<li><p>TP = True positive</p></li>
<li><p>TN = True negative</p></li>
<li><p>FP = False positive</p></li>
<li><p>FN = False negative</p></li>
</ul>
<p>When accuracy = 1.0, this indicates a perfect classifier, while 0.0 indicates no skill. However, accuracy can be missleading if our classes are imbalanced.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_binary_val</span><span class="p">,</span><span class="n">y_val_predicted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.882479038341519
</pre></div>
</div>
</div>
</div>
<p><strong>Precision</strong> tells us how accurately the classifier is able to identify objects of a specific class. It is defined as</p>
<p><span class="math notranslate nohighlight">\( precision = \frac{TP}{TP + FP}\)</span>.</p>
<p>High <em>precision</em> means that we will tolerate <em>false negatives</em>, but have as few <em>false positives</em> as possible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_binary_val</span><span class="p">,</span> <span class="n">y_val_predicted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8656080331601378
</pre></div>
</div>
</div>
</div>
<p><strong>Recall</strong> tells us how many of the objects of a class are correctly identified. It is defined as</p>
<p><span class="math notranslate nohighlight">\(recall = \frac{TP}{TP+FN}\)</span></p>
<p>High <em>recall</em> means that we will tolerate <em>false positives</em>, but try to have as few <em>false negatives</em> as possible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_binary_val</span><span class="p">,</span> <span class="n">y_val_predicted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8796274323682961
</pre></div>
</div>
</div>
</div>
<p>Finally, if we want to find a balance between precision and recall, we can evaluate the F1 score:</p>
<p><span class="math notranslate nohighlight">\(F_{1} = \frac{2}{recall^{-1}+precision^{-1}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_binary_val</span><span class="p">,</span> <span class="n">y_val_predicted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8725614241577166
</pre></div>
</div>
</div>
</div>
<section id="roc-curve">
<h3>ROC curve<a class="headerlink" href="#roc-curve" title="Permalink to this heading">#</a></h3>
<p>The Reciever Operator Characteristic (ROC) curve can be used to evaluate the performance of a binary classifier. Because there is a trade-off between true positives and false positives depending on where we set the threshold for identifying the two classes, the ROC curve can visualize this trade-off. A classifier with no skill would line on the diagnol dashed line, and a perfect classifier would have a curve reaching the top-left corner of the plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">RocCurveDisplay</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svc_disp</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">log_reg</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_binary_val</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fc40758e1a969a3918194e7c88e932067cde9802e50f92d1ca5e50dd1388c2f2.png" src="../../_images/fc40758e1a969a3918194e7c88e932067cde9802e50f92d1ca5e50dd1388c2f2.png" />
</div>
</div>
</section>
<section id="importance-of-different-features-for-logistic-regression">
<h3>Importance of different features for logistic regression<a class="headerlink" href="#importance-of-different-features-for-logistic-regression" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coefficients</span> <span class="o">=</span> <span class="n">log_reg</span><span class="o">.</span><span class="n">coef_</span>
<span class="n">coefficients</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 39)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">featurenames</span><span class="p">,</span><span class="n">coefficients</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Coefficient values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Feature&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/bc68593bcae2e59f3af5b2365a406af787da8873273d23c8bedffd777221d25f.png" src="../../_images/bc68593bcae2e59f3af5b2365a406af787da8873273d23c8bedffd777221d25f.png" />
</div>
</div>
</section>
</section>
<section id="train-a-decision-tree-classifier">
<h2>Train a decision tree classifier<a class="headerlink" href="#train-a-decision-tree-classifier" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree_clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">tree_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_binary_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>DecisionTreeClassifier(max_depth=2, random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">DecisionTreeClassifier</label><div class="sk-toggleable__content"><pre>DecisionTreeClassifier(max_depth=2, random_state=42)</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>graphviz
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: graphviz in /opt/anaconda3/envs/ML4Climate2025/lib/python3.8/site-packages (0.20.3)
</pre></div>
</div>
</div>
</div>
<p>We can directly visualize the decision tree using the graphviz library, and look at what thresholds it is using at each node.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Source</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">export_graphviz</span>

<span class="n">export_graphviz</span><span class="p">(</span>
        <span class="n">tree_clf</span><span class="p">,</span>
        <span class="n">out_file</span><span class="o">=</span><span class="s2">&quot;decision_tree.dot&quot;</span><span class="p">,</span>
        <span class="n">feature_names</span><span class="o">=</span><span class="n">featurenames</span><span class="p">,</span>
        <span class="n">class_names</span><span class="o">=</span><span class="n">classnames_binary</span><span class="p">,</span>
        <span class="n">rounded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">filled</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

<span class="c1"># Read the dot file </span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;decision_tree.dot&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">dot_graph</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c1"># Adjust dpi for scaling</span>
<span class="n">dot_graph</span> <span class="o">=</span> <span class="s1">&#39;digraph Tree {</span><span class="se">\n</span><span class="s1">dpi=50;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">dot_graph</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">Source</span><span class="p">(</span><span class="n">dot_graph</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b24f02963fc6dc6415e7d424da021729c696b277a81ec3e9fa6139e84d7d775d.svg" src="../../_images/b24f02963fc6dc6415e7d424da021729c696b277a81ec3e9fa6139e84d7d775d.svg" /></div>
</div>
<p>Let’s train decision trees with greater max_depth and see how they perform on the validation data set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">depths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="n">trained_decisiontrees</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">depths</span><span class="p">:</span>
    <span class="n">tree_clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">trained_decisiontrees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tree_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_binary_train</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_val_predicted</span> <span class="o">=</span> <span class="n">trained_decisiontrees</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_val_predicted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 0, 1, ..., 1, 1, 0])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ConfusionMatrixDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">trained_decisiontrees</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">X_val</span><span class="p">,</span><span class="n">y_binary_val</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="n">display_labels</span><span class="o">=</span><span class="n">classnames_binary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x34cf15280&gt;
</pre></div>
</div>
<img alt="../../_images/265bbe3d785a5c74c32ce3c1b6801a50f4a7191b22a11f75cccb3e6cdf73da18.png" src="../../_images/265bbe3d785a5c74c32ce3c1b6801a50f4a7191b22a11f75cccb3e6cdf73da18.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ConfusionMatrixDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">trained_decisiontrees</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">X_val</span><span class="p">,</span><span class="n">y_binary_val</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="n">display_labels</span><span class="o">=</span><span class="n">classnames_binary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x34d442ac0&gt;
</pre></div>
</div>
<img alt="../../_images/09f87d33b5701aff7e99ffc2d8d799d3516be71a8a23ef5a0407f3b866cb6ae5.png" src="../../_images/09f87d33b5701aff7e99ffc2d8d799d3516be71a8a23ef5a0407f3b866cb6ae5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ConfusionMatrixDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">trained_decisiontrees</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">X_val</span><span class="p">,</span><span class="n">y_binary_val</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="n">display_labels</span><span class="o">=</span><span class="n">classnames_binary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x16d267d60&gt;
</pre></div>
</div>
<img alt="../../_images/e166bcc0ce25b29b979501069ec367388a6d9c40a04d6ca580df21790f819e6c.png" src="../../_images/e166bcc0ce25b29b979501069ec367388a6d9c40a04d6ca580df21790f819e6c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ConfusionMatrixDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">trained_decisiontrees</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">X_val</span><span class="p">,</span><span class="n">y_binary_val</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="n">display_labels</span><span class="o">=</span><span class="n">classnames_binary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x34dae8070&gt;
</pre></div>
</div>
<img alt="../../_images/3d9473c50b69294d8c88339dbbb6fa5ff85afe32bd1211e5c807b8145d6e71f2.png" src="../../_images/3d9473c50b69294d8c88339dbbb6fa5ff85afe32bd1211e5c807b8145d6e71f2.png" />
</div>
</div>
<p>We can compare the performance of a the trained decision tree to logistic regression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">svc_disp</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">log_reg</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_binary_val</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">svc_disp</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">trained_decisiontrees</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_binary_val</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/72ea42a81ac5c6b86dce0353c20aa58a2f35135ec0d65ba84522926394fa1cd5.png" src="../../_images/72ea42a81ac5c6b86dce0353c20aa58a2f35135ec0d65ba84522926394fa1cd5.png" />
</div>
</div>
</section>
<section id="train-a-random-forest-classifier">
<h2>Train a random forest classifier<a class="headerlink" href="#train-a-random-forest-classifier" title="Permalink to this heading">#</a></h2>
<p>A random forest is an ensemble of decision trees. Each decision tree is grown on a different sub-sample of the data set, and their ensemble vote is typically better than that of a single decision tree. They are quite powerful methods that are still used widely in environmental science and climate research, and are particularly good on tabular data sets. They can however be rather slow to train if the training data set is large.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rnd_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rnd_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_binary_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-3 {color: black;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestClassifier(random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" checked><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">RandomForestClassifier</label><div class="sk-toggleable__content"><pre>RandomForestClassifier(random_state=42)</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ConfusionMatrixDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">rnd_clf</span><span class="p">,</span><span class="n">X_val</span><span class="p">,</span><span class="n">y_binary_val</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="n">display_labels</span><span class="o">=</span><span class="n">classnames_binary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x16d20de20&gt;
</pre></div>
</div>
<img alt="../../_images/8ffe8e0e86c3a36d439e0cee571afba0fc5d5bf2286960dd8da2452c5ec7ce4f.png" src="../../_images/8ffe8e0e86c3a36d439e0cee571afba0fc5d5bf2286960dd8da2452c5ec7ce4f.png" />
</div>
</div>
<p>We can compare the trained random forest with the decision tree and logistic regression. In this case the random forest does give us some improvement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">svc_disp</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">log_reg</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_binary_val</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">svc_disp</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">trained_decisiontrees</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_binary_val</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">svc_disp</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">rnd_clf</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_binary_val</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ea3724dd09236b26cd5329a820e6ab262611d74ed59ad1b2d6d4ff4a3bb6f5cd.png" src="../../_images/ea3724dd09236b26cd5329a820e6ab262611d74ed59ad1b2d6d4ff4a3bb6f5cd.png" />
</div>
</div>
<section id="feature-importance">
<h3>Feature importance<a class="headerlink" href="#feature-importance" title="Permalink to this heading">#</a></h3>
<p>With random forests, we can also get some ideas of which features are the most important for our classifier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rnd_clf</span><span class="o">.</span><span class="n">feature_importances_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.03678424, 0.010523  , 0.00857334, 0.01493381, 0.01567114,
       0.02743097, 0.07660563, 0.04684962, 0.01184543, 0.01285308,
       0.01466824, 0.0617133 , 0.02268836, 0.01251963, 0.09073005,
       0.01565229, 0.00856963, 0.01815727, 0.01130637, 0.02685617,
       0.0824383 , 0.02938211, 0.00523526, 0.02220977, 0.0093963 ,
       0.02086468, 0.00383213, 0.01152713, 0.11698223, 0.01991252,
       0.02078227, 0.03123305, 0.01249902, 0.01197704, 0.01121416,
       0.01153355, 0.01094183, 0.0116142 , 0.01149288])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">featurenames</span><span class="p">,</span><span class="n">rnd_clf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Feature Importance&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Feature&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/eca729aafa2dada23d33e3d6d7ae231d0e9d600ab7d1ffbcb0e2be1b935718c2.png" src="../../_images/eca729aafa2dada23d33e3d6d7ae231d0e9d600ab7d1ffbcb0e2be1b935718c2.png" />
</div>
</div>
</section>
<section id="multiclass-classification-with-the-random-forest">
<h3>Multiclass classification with the Random Forest<a class="headerlink" href="#multiclass-classification-with-the-random-forest" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rnd_multiclass_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">class_weight</span> <span class="o">=</span> <span class="s2">&quot;balanced&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">rnd_multiclass_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_multiclass_train</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>31.7999427318573
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the depth of each tree</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tree</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rnd_multiclass_clf</span><span class="o">.</span><span class="n">estimators_</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tree </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: Depth = </span><span class="si">{</span><span class="n">tree</span><span class="o">.</span><span class="n">get_depth</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tree 1: Depth = 45
Tree 2: Depth = 46
Tree 3: Depth = 49
Tree 4: Depth = 43
Tree 5: Depth = 50
Tree 6: Depth = 50
Tree 7: Depth = 48
Tree 8: Depth = 48
Tree 9: Depth = 44
Tree 10: Depth = 59
Tree 11: Depth = 50
Tree 12: Depth = 46
Tree 13: Depth = 51
Tree 14: Depth = 51
Tree 15: Depth = 43
Tree 16: Depth = 48
Tree 17: Depth = 47
Tree 18: Depth = 47
Tree 19: Depth = 46
Tree 20: Depth = 51
Tree 21: Depth = 50
Tree 22: Depth = 43
Tree 23: Depth = 44
Tree 24: Depth = 47
Tree 25: Depth = 48
Tree 26: Depth = 50
Tree 27: Depth = 48
Tree 28: Depth = 47
Tree 29: Depth = 48
Tree 30: Depth = 47
</pre></div>
</div>
</div>
</div>
<p>This can be slow. If we want to train a model and save the trained weights, we can use pickle so we don’t need to train this again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;rnd_multiclass_clf.pkl&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">rnd_multiclass_clf</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then we can load the weights in later using the following lines.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We can evaluate the trained multi-class classifier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmp</span> <span class="o">=</span> <span class="n">ConfusionMatrixDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">rnd_multiclass_clf</span><span class="p">,</span><span class="n">X_val</span><span class="p">,</span><span class="n">y_multiclass_val</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                                      <span class="n">display_labels</span><span class="o">=</span><span class="n">classnames_multi</span><span class="p">,</span> <span class="n">xticks_rotation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span><span class="n">include_values</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e188fba8dbea4dd0ea450c3009e7b108a0b003a0a26722ff69c7d124e79edea1.png" src="../../_images/e188fba8dbea4dd0ea450c3009e7b108a0b003a0a26722ff69c7d124e79edea1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_val_predicted</span> <span class="o">=</span> <span class="n">rnd_multiclass_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_val_predicted</span><span class="p">,</span><span class="n">y_multiclass_val</span><span class="p">,</span><span class="n">target_names</span> <span class="o">=</span> <span class="n">classnames_multi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                            precision    recall  f1-score   support

                        Arson/incendiarism       0.43      0.53      0.47      2214
                   Debris and open burning       0.57      0.51      0.54      4606
                 Equipment and vehicle use       0.62      0.51      0.56      6016
               Firearms and explosives use       0.46      0.96      0.62        72
                                 Fireworks       0.36      0.59      0.45       389
                 Misuse of fire by a minor       0.10      0.34      0.16       354
                                   Natural       0.96      0.80      0.87     20021
                              Other causes       0.00      0.08      0.01        13
Power generation/transmission/distribution       0.05      0.49      0.10        67
       Railroad operations and maintenance       0.11      0.69      0.18        49
                   Recreation and ceremony       0.42      0.59      0.49      2681
                                   Smoking       0.10      0.36      0.16       371

                                  accuracy                           0.68     36853
                                 macro avg       0.35      0.54      0.38     36853
                              weighted avg       0.76      0.68      0.71     36853
</pre></div>
</div>
</div>
</div>
<p>The classes are pretty imbalanced, so one approach we can try is over-sampling the classes that are not well-represented.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>imbalanced-learn
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: imbalanced-learn in /opt/anaconda3/envs/ML4Climate2025/lib/python3.8/site-packages (0.12.4)
Requirement already satisfied: numpy&gt;=1.17.3 in /opt/anaconda3/envs/ML4Climate2025/lib/python3.8/site-packages (from imbalanced-learn) (1.24.3)
Requirement already satisfied: scipy&gt;=1.5.0 in /opt/anaconda3/envs/ML4Climate2025/lib/python3.8/site-packages (from imbalanced-learn) (1.10.1)
Requirement already satisfied: scikit-learn&gt;=1.0.2 in /opt/anaconda3/envs/ML4Climate2025/lib/python3.8/site-packages (from imbalanced-learn) (1.3.2)
Requirement already satisfied: joblib&gt;=1.1.1 in /opt/anaconda3/envs/ML4Climate2025/lib/python3.8/site-packages (from imbalanced-learn) (1.4.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /opt/anaconda3/envs/ML4Climate2025/lib/python3.8/site-packages (from imbalanced-learn) (3.5.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">SMOTE</span>
</pre></div>
</div>
</div>
</div>
<p>The SMOTE algorithm interpolates between the points in each class in order to create new examples similar to the training data set in order to augment the data set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sm</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_multiclass_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This makes our data set much larger however.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_resampled</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1611324, 39)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_resampled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.465338877846595
</pre></div>
</div>
</div>
</div>
<p>We will randomly sample the resampled data set so that we will have the same size as the original training data set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">X_resampled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">X_balanced</span> <span class="o">=</span> <span class="n">X_resampled</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">y_balanced</span> <span class="o">=</span> <span class="n">y_resampled</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rnd_multiclass_clf2</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">class_weight</span> <span class="o">=</span> <span class="s2">&quot;balanced&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">rnd_multiclass_clf2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_balanced</span><span class="p">,</span><span class="n">y_balanced</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>51.82860088348389
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmp</span> <span class="o">=</span> <span class="n">ConfusionMatrixDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">rnd_multiclass_clf2</span><span class="p">,</span><span class="n">X_val</span><span class="p">,</span><span class="n">y_multiclass_val</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                                      <span class="n">display_labels</span><span class="o">=</span><span class="n">classnames_multi</span><span class="p">,</span> <span class="n">xticks_rotation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span><span class="n">include_values</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/660be5753fe4be075ed84c9b5e415cc40cca4dba43b2f8594f8307dc925bcb56.png" src="../../_images/660be5753fe4be075ed84c9b5e415cc40cca4dba43b2f8594f8307dc925bcb56.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_val_predicted_oversampled</span> <span class="o">=</span> <span class="n">rnd_multiclass_clf2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_val_predicted_oversampled</span><span class="p">,</span><span class="n">y_multiclass_val</span><span class="p">,</span><span class="n">target_names</span> <span class="o">=</span> <span class="n">classnames_multi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                            precision    recall  f1-score   support

                        Arson/incendiarism       0.41      0.45      0.43      2509
                   Debris and open burning       0.50      0.53      0.51      3892
                 Equipment and vehicle use       0.48      0.53      0.50      4364
               Firearms and explosives use       0.65      0.31      0.42       313
                                 Fireworks       0.54      0.34      0.42      1030
                 Misuse of fire by a minor       0.26      0.22      0.24      1344
                                   Natural       0.86      0.90      0.88     16183
                              Other causes       0.15      0.07      0.09       469
Power generation/transmission/distribution       0.23      0.15      0.18       943
       Railroad operations and maintenance       0.34      0.19      0.24       568
                   Recreation and ceremony       0.53      0.49      0.51      4090
                                   Smoking       0.20      0.24      0.22      1148

                                  accuracy                           0.63     36853
                                 macro avg       0.43      0.37      0.39     36853
                              weighted avg       0.62      0.63      0.63     36853
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">featurenames</span><span class="p">,</span><span class="n">rnd_multiclass_clf2</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Feature Importance&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Feature&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ed035a7b8e1277a1b2708fe4b02b0e4b687b6e97620e95aac12e479087029aee.png" src="../../_images/ed035a7b8e1277a1b2708fe4b02b0e4b687b6e97620e95aac12e479087029aee.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lectures_ML/SupervisedML"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="supervisedml.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Supervised Machine Learning</p>
      </div>
    </a>
    <a class="right-next"
       href="../../assignments/Assignment2.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Assignment 2: Predicting Health Impacts from Air Quality Factors</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-in-the-data-set">Load in the data set</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#separate-out-the-fires-with-no-known-cause">Separate out the fires with no known cause</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-pre-processing">Data Pre-Processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-validation-and-test-split">Training, validation, and test split</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-logistic-regression-natural-vs-human-causes">Train logistic regression (natural vs. human causes)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#roc-curve">ROC curve</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importance-of-different-features-for-logistic-regression">Importance of different features for logistic regression</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-a-decision-tree-classifier">Train a decision tree classifier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-a-random-forest-classifier">Train a random forest classifier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-importance">Feature importance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiclass-classification-with-the-random-forest">Multiclass classification with the Random Forest</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kara Lamb & Dhruv Balwada
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>